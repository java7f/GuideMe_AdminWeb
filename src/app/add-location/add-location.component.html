<div class="container">
	<h3 *ngIf="!locationId; else editLocation">Add new location</h3>
	<div class="row border-top mt-3">
		<div class="col-6 col-sm-6" style="border-right: 1px solid #dee2e6;">
			<div class="container">
				<!-- Location title input -->
				<div class="row mt-5">
					<div class="col-lg-12">
						<h4>Location title</h4>
						<div class="row row-grid">
							<div class="col-sm-6 col-lg-8 mb-4">
								<div class="form-group">
									<input class="form-control" placeholder="Enter title" type="text"
										[(ngModel)]="locationInfo.name" />
								</div>
							</div>
						</div>
					</div>
				</div>
				<!---->
				<!-- Location image input -->
				<div class="card mt-4">
					<div class="card-header">
						Upload Cover Image
					</div>
					<div [innerHtml]='msg' *ngIf="msg" style="color: red;" class="mb-4"></div>
					<img class="card-img-top" *ngIf="url" [src]="url">
					<div class="card-body">
						<input type="file" (change)="onFileChanged($event)" style="display: none" #fileInput>
						<button (click)="fileInput.click()" class="btn btn-warning mr-1">Select File</button>
					</div>
				</div>
				<!---->
				<!-- Location address input -->
				<div class="row justify-content-center mt-5">
					<div class="col-lg-12">
						<h4>Select location address</h4>
						<div class="row mt-4">
							<div class="col-lg-12">
								<input #mapSearchField placeholder="Search" type="text" class="rounded p-2 mt-2"
									style="width:40%;margin-left:150px;" />
								<google-map width="100%" height="400px">
                                    <map-marker
                                        [position]="markerPosition" [options]="markerOptions">
                                    </map-marker>
                                </google-map>
							</div>
						</div>
					</div>
				</div>
				<!---->
			</div>
            <div class="row mt-5 mb-5">
                <div class="col-lg-12">
                    <div class="text-center">
                        <button class="btn btn-primary btn-round w-75 mt-5" (click)="saveLocation()">Save Location</button>
                    </div>
                </div>
            </div>
		</div>
		<div class="col-sm-6">
			<div class="container">
				<!-- Audio file input -->
				<div class="row mt-5">
					<h4>Upload Audio File</h4>
					<div class="col-6 mt-4">
						<input type="file" (change)="handleFileInput($event)" style="display: none" #audioFileInput>
						<button (click)="audioFileInput.click()" class="btn btn-warning mr-2">Select Files</button>
					</div>
					<div class="col-6 mt-4">
						<button (click)="saveAudiofile()" class="btn btn-primary mr-1 float-end">Save Audio</button>
					</div>
				</div>
				<div [innerHtml]='audiomsg' *ngIf="audiomsg" style="color: red;" class="mt-3"></div>
				<div *ngIf="status" class="mt-3">{{ audioguide.name }} ready!</div>
				<div *ngIf="audioFileSaved === 'yes'" class="alert alert-success alert-dismissible fade show mt-3"
					role="alert">
					<strong>Success!</strong> Audio file was succesfully saved
					<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
				</div>
				<div *ngIf="audioFileSaved === 'no'" class="alert alert-danger alert-dismissible fade show mt-3"
					role="alert">
					<strong>Error!</strong> Audio file could not be saved
					<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
				</div>
				<!---->
				<!-- Audio display -->
				<div class="row mt-4">
					<div *ngIf="audioguideList">
						<div *ngFor="let audio of audioguideList">
							<div class="card mb-3">
								<div class="card-header">
									{{ audio.name }}
									<div class="float-end">
										<button type="button" class="btn btn-secondary" 
												style="margin-right:10px;" data-bs-toggle="modal" 
												data-bs-target="#staticBackdrop">Edit</button>
										<button type="button" class="btn btn-danger"
											(click)="deleteAudioguide(audio.id)">Delete</button>	
									</div>
								</div>
								<div class="card-body">
									<vm-player controls>
										<vm-audio>
											<source data-src={{audio.audioguideUrl}} type="audio/mp3" />
										</vm-audio>
									</vm-player>
								</div>
							</div>
						</div>
					</div>
				</div>
				<!---->
				<!-- Modal -->
				<div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
					<div class="modal-dialog">
	  					<div class="modal-content">
							<div class="modal-header">
		  						<h5 class="modal-title" id="staticBackdropLabel">Edit Location</h5>
		  						<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
							</div>
							<div class="modal-body">
								<div class="mb-3">
									<label for="location-name" class="col-form-label">Location name:</label>
									<input type="text" class="form-control" id="location-name">
								</div>
								<div class="mb-4">
									<label for="mac-address" class="col-form-label">Beacon MAC address:</label>
									<input type="text" class="form-control" id="mac-address">
								</div>
								<div class="mb-3">
									<select class="form-select" aria-label="Default select example">
										<option selected>Select language</option>
										<option value="1">Spanish</option>
										<option value="2">English</option>
										<option value="3">German</option>
									  </select>
								</div>
							</div>
							<div class="modal-footer">
		  						<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
		  						<button type="button" class="btn btn-primary">Save</button>
							</div>
	  					</div>
					</div>
  				</div>
				<!-- test -->
				<vm-player controls>
					<vm-audio>
						<source data-src="https://www.learningcontainer.com/wp-content/uploads/2020/02/Kalimba.mp3"
							type="audio/mp3" />
					</vm-audio>
				</vm-player>
			</div>
		</div>
	</div>
    <div class="row mt-5 mb-5">
        <div class="col-lg-12">
            <div class="text-center">
                <button class="btn btn-cancel btn-round  w-75 mt-5" (click)="cancel()">Cancel</button>
            </div>
        </div>
    </div>
</div>

<ng-template #editLocation>
    <h3>Edit Location</h3>
</ng-template>